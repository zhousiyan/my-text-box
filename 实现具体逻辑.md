#  源码具体实现逻辑  
## 主要的核心方法监听事件  
首先建立一个文本框的keydown事件，click事件，input事件 和 下拉菜单的click事件
### 先是文本框的input事件  
**这个事件主要输出的实时判断是否出现特殊符号出现下拉菜单，跟踪定位光标的位置**
~~~js  
        this.editor.addEventListener('input', (event)=>{
            let tag =  event.target;
            let v = tag.value;
            let intercept = this.editor.value;
            
            //tentative方法判断是否在光标前一个字符串是否是特殊字符串，决定是否出现下拉菜单选项
            this.tentative(intercept);

            //getlocation克隆文本框样式的div元素，用第一个span元素记录文本框输的字符串，还有span元素添加这个符号"|"可以计算真光标的位置，  
            //返回所计算过的top和left的值，便于下拉菜单定位到真光标的位置
            let pos =  this.getlocation(tag);
            this.track.style.left = pos.left + 'px';
            this.track.style.top = pos.top +'px';
            //想看到tentative和getlocation具体实现，在下面就可以找到
~~~  

### 文本框的click事件  
**当点击的时候光标的位置发生变化，这个事件就可以实时监听光标位置，以下实现逻辑跟输出事件是一样的，以后我会将两事件合并在一起**
~~~js  
this.editor.addEventListener('click', (event) => {
            let tag =  event.target;
            this.pp = this.editor.value;
            console.log(this.pp);
            // 判断光标字段
            this.tentative(this.pp);

            let pos =  this.getlocation(tag);
            this.track.style.left = pos.left + 'px';
            this.track.style.top = pos.top +'px';
        })
~~~  

### 文本框的keydown事件  
**这事件运用方向键选择中具体选项，回车输出该选项的值到文本框里面**
~~~js
this.editor.addEventListener('keydown',(event) => {
            let keycode = event.keyCode;
            if (this.track.style.display == 'block' && this.ul.style.display == 'block') {
                    if (keycode == 38) {
                        event.returnValue = false;
                        console.log('up');
                        this.index -= 1;
                    if (this.index == -1) {this.index = this.li.length - 1};
                    this.stylemove(this.li);
                }
                    else if (keycode == 40) {
                        event.returnValue = false;
                        console.log('down');
                        this.index += 1;
                        if (this.index == this.li.length) {this.index = 0};
                        this.stylemove(this.li);
                }

                else if (keycode == 13) {
                    event.returnValue = false;
                    var w = this.li[this.index].dataset.index
                    this.add(w);
                    event.returnValue = true;
                }
            }
            else {
                event.returnValue = true;
            }
            
        })
    }  
~~~
### 下拉菜单的click事件  
**点击选项输出到文本框的值里面**  
~~~js  
this.ul.addEventListener('click', (event) =>{
            let t = event.target.dataset.index;
            console.log(t);
            //由冒泡点击的增加的
            this.add(t);
            editor.focus();
        })
~~~
